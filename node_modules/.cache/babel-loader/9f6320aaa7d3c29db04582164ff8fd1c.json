{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.TorusWalletAdapter = exports.TorusWalletName = void 0;\n\nconst wallet_adapter_base_1 = require(\"@solana/wallet-adapter-base\");\n\nconst web3_js_1 = require(\"@solana/web3.js\");\n\nexports.TorusWalletName = 'Torus';\n\nclass TorusWalletAdapter extends wallet_adapter_base_1.BaseMessageSignerWalletAdapter {\n  constructor() {\n    let {\n      params = {\n        showTorusButton: false\n      }\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n      params: {\n        showTorusButton: false\n      }\n    };\n    super();\n    this.name = exports.TorusWalletName;\n    this.url = 'https://tor.us';\n    this.icon = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzMiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMyAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMTYuNSIgY3k9IjE2IiByPSIxNiIgZmlsbD0iIzAzNjRGRiIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTExLjIxODYgOS40OTIxOUMxMC40NTM5IDkuNDkyMTkgOS44MzM5OCAxMC4xMTIxIDkuODMzOTggMTAuODc2OFYxMi40ODk4QzkuODMzOTggMTMuMjU0NSAxMC40NTM5IDEzLjg3NDQgMTEuMjE4NiAxMy44NzQ0SDEzLjY2ODRWMjIuODk3NkMxMy42Njg0IDIzLjY2MjMgMTQuMjg4MyAyNC4yODIyIDE1LjA1MyAyNC4yODIySDE2LjY2NkMxNy40MzA3IDI0LjI4MjIgMTguMDUwNiAyMy42NjIzIDE4LjA1MDYgMjIuODk3NlYxMi41MDE1QzE4LjA1MDYgMTIuNDk3NiAxOC4wNTA2IDEyLjQ5MzcgMTguMDUwNiAxMi40ODk4VjEwLjg3NjhDMTguMDUwNiAxMC4xMTIxIDE3LjQzMDcgOS40OTIxOSAxNi42NjYgOS40OTIxOUgxNS4wNTNIMTEuMjE4NloiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0yMS4zMzc2IDEzLjg3NDRDMjIuNTQ3NyAxMy44NzQ0IDIzLjUyODcgMTIuODkzNCAyMy41Mjg3IDExLjY4MzNDMjMuNTI4NyAxMC40NzMyIDIyLjU0NzcgOS40OTIxOSAyMS4zMzc2IDkuNDkyMTlDMjAuMTI3NSA5LjQ5MjE5IDE5LjE0NjUgMTAuNDczMiAxOS4xNDY1IDExLjY4MzNDMTkuMTQ2NSAxMi44OTM0IDIwLjEyNzUgMTMuODc0NCAyMS4zMzc2IDEzLjg3NDRaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K';\n    this._readyState = typeof window === 'undefined' || typeof document === 'undefined' ? wallet_adapter_base_1.WalletReadyState.Unsupported : wallet_adapter_base_1.WalletReadyState.Loadable;\n    this._connecting = false;\n    this._wallet = null;\n    this._publicKey = null;\n    this._params = params;\n  }\n\n  get publicKey() {\n    return this._publicKey;\n  }\n\n  get connecting() {\n    return this._connecting;\n  }\n\n  get connected() {\n    var _a;\n\n    return !!((_a = this._wallet) === null || _a === void 0 ? void 0 : _a.isLoggedIn);\n  }\n\n  get readyState() {\n    return this._readyState;\n  }\n\n  connect() {\n    return __awaiter(this, void 0, void 0, function* () {\n      try {\n        if (this.connected || this.connecting) return;\n        if (this._readyState !== wallet_adapter_base_1.WalletReadyState.Loadable) throw new wallet_adapter_base_1.WalletNotReadyError();\n        this._connecting = true;\n        let TorusClass;\n\n        try {\n          ({\n            default: TorusClass\n          } = yield Promise.resolve().then(() => __importStar(require('@toruslabs/solana-embed'))));\n        } catch (error) {\n          throw new wallet_adapter_base_1.WalletLoadError(error === null || error === void 0 ? void 0 : error.message, error);\n        }\n\n        let wallet;\n\n        try {\n          wallet = window.torus || new TorusClass();\n        } catch (error) {\n          throw new wallet_adapter_base_1.WalletConfigError(error === null || error === void 0 ? void 0 : error.message, error);\n        }\n\n        if (!wallet.isInitialized) {\n          try {\n            yield wallet.init(this._params);\n          } catch (error) {\n            throw new wallet_adapter_base_1.WalletConnectionError(error === null || error === void 0 ? void 0 : error.message, error);\n          }\n        }\n\n        let accounts;\n\n        try {\n          accounts = yield wallet.login();\n        } catch (error) {\n          throw new wallet_adapter_base_1.WalletAccountError(error === null || error === void 0 ? void 0 : error.message, error);\n        }\n\n        let publicKey;\n\n        try {\n          publicKey = new web3_js_1.PublicKey(accounts[0]);\n        } catch (error) {\n          throw new wallet_adapter_base_1.WalletPublicKeyError(error === null || error === void 0 ? void 0 : error.message, error);\n        }\n\n        this._wallet = wallet;\n        this._publicKey = publicKey;\n        this.emit('connect', publicKey);\n      } catch (error) {\n        this.emit('error', error);\n        throw error;\n      } finally {\n        this._connecting = false;\n      }\n    });\n  }\n\n  disconnect() {\n    return __awaiter(this, void 0, void 0, function* () {\n      const wallet = this._wallet;\n\n      if (wallet) {\n        this._wallet = null;\n        this._publicKey = null;\n\n        try {\n          if (wallet.isLoggedIn) yield wallet.cleanUp();\n        } catch (error) {\n          this.emit('error', new wallet_adapter_base_1.WalletDisconnectionError(error === null || error === void 0 ? void 0 : error.message, error));\n        }\n      }\n\n      this.emit('disconnect');\n    });\n  }\n  /*\n  FIXME: https://github.com/solana-labs/wallet-adapter/pull/515#issuecomment-1215763729\n   async sendTransaction(\n      transaction: Transaction,\n      connection: Connection,\n      options: SendTransactionOptions = {}\n  ): Promise<TransactionSignature> {\n      try {\n          const wallet = this._wallet;\n          if (!wallet) throw new WalletNotConnectedError();\n           try {\n              const { signers, ...sendOptions } = options;\n               transaction = await this.prepareTransaction(transaction, connection, sendOptions);\n               signers?.length && transaction.partialSign(...signers);\n               sendOptions.preflightCommitment = sendOptions.preflightCommitment || connection.commitment;\n               const { signature } = await wallet.signAndSendTransaction(transaction, sendOptions);\n              return signature;\n          } catch (error: any) {\n              if (error instanceof WalletError) throw error;\n              throw new WalletSendTransactionError(error?.message, error);\n          }\n      } catch (error: any) {\n          this.emit('error', error);\n          throw error;\n      }\n  }\n  */\n\n\n  signTransaction(transaction) {\n    return __awaiter(this, void 0, void 0, function* () {\n      try {\n        const wallet = this._wallet;\n        if (!wallet) throw new wallet_adapter_base_1.WalletNotConnectedError();\n\n        try {\n          return (yield wallet.signTransaction(transaction)) || transaction;\n        } catch (error) {\n          throw new wallet_adapter_base_1.WalletSignTransactionError(error === null || error === void 0 ? void 0 : error.message, error);\n        }\n      } catch (error) {\n        this.emit('error', error);\n        throw error;\n      }\n    });\n  }\n\n  signAllTransactions(transactions) {\n    return __awaiter(this, void 0, void 0, function* () {\n      try {\n        const wallet = this._wallet;\n        if (!wallet) throw new wallet_adapter_base_1.WalletNotConnectedError();\n\n        try {\n          return (yield wallet.signAllTransactions(transactions)) || transactions;\n        } catch (error) {\n          throw new wallet_adapter_base_1.WalletSignTransactionError(error === null || error === void 0 ? void 0 : error.message, error);\n        }\n      } catch (error) {\n        this.emit('error', error);\n        throw error;\n      }\n    });\n  }\n\n  signMessage(message) {\n    return __awaiter(this, void 0, void 0, function* () {\n      try {\n        const wallet = this._wallet;\n        if (!wallet) throw new wallet_adapter_base_1.WalletNotConnectedError();\n\n        try {\n          return yield wallet.signMessage(message);\n        } catch (error) {\n          throw new wallet_adapter_base_1.WalletSignMessageError(error === null || error === void 0 ? void 0 : error.message, error);\n        }\n      } catch (error) {\n        this.emit('error', error);\n        throw error;\n      }\n    });\n  }\n\n}\n\nexports.TorusWalletAdapter = TorusWalletAdapter;","map":{"version":3,"mappings":"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","names":["exports","TorusWalletAdapter","wallet_adapter_base_1","constructor","params","showTorusButton","window","document","Unsupported","Loadable","_connecting","_wallet","_publicKey","_params","publicKey","connecting","connected","_a","isLoggedIn","readyState","_readyState","connect","TorusClass","default","error","message","wallet","torus","isInitialized","init","accounts","login","web3_js_1","emit","disconnect","cleanUp","signTransaction","transaction","signAllTransactions","transactions","signMessage"],"sourceRoot":"","sources":["../../src/adapter.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}